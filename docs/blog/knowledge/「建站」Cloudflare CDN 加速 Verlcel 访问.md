# Cloudflare CDN 加速 Verlcel 访问

## 0x01 什么是CDN

内容分发网络（CDN，Content Delivery Network）是一种分布式网络架构，它将网站的静态资源（图片、视频、CSS、JavaScript等）缓存到全球各地的服务器上，用户访问网站时，可以从距离自己最近的服务器获取所需要的内容，从而大大减少了数据传输的延迟，提升了网站的加载速度和响应能力。

CDN的核心优势在于它的分布式缓存机制，通过将网站内容分发到全球各地的服务器上，CDN能够实现对用户的就近访问，有效的减轻服务器的负载压力，同时降低了网络拥塞的可能性，此外，CDN还提供了高可用性和可扩展性，即使部分服务器出现故障或者访问量激增，也能保证网站的正常访问。

![](https://takuya-1305710862.cos.ap-shanghai.myqcloud.com/A1ways0nline/pic/20241010095122.png)

用个通俗的说法来解释，就是CDN的服务公司（CloudFlare）通过在全球各地建立很多的服务器，然后当你加入他们的网络之后，他们会缓存（复制）你的网站上的内容到各地的服务器上，这样的话如果有附近的访客访问你的网站的时候，他们就会直接从距离他们IP地理位置最近的缓存服务器上读取到你的网站的内容，而不需要跑到网站原始服务器上去读取内容，大大缩减了访客看到你网站的时间，变相缩减了网站的加载时间。

另外，从安全性角度出发，如果你的网站是部署在云服务器端，那么CDN从某种角度上来说还可以隐藏真实网站服务器的地址（当然，花点精力还是有很多方法可以获取到真实的IP的），并且还能够从一定程度上防止了DDoS攻击。从下面这张图可以看到，从不同的地址位置来访问我们的博客网站，响应的IP地址都是不一样的。

![](https://takuya-1305710862.cos.ap-shanghai.myqcloud.com/A1ways0nline/pic/20241010094740.png)

说到CDN的原理时，那么就需要说到DNS、Anycast这些了。

[参考文章1：深入理解 CDN 服务, 并使用 Cloudflare 优化网络链路](https://rapidsu.cn/articles/3872)

[参考文章2：什么是CDN? 独立站速度优化之Cloudflare CDN](https://www.qingsongb2c.com/speed-up-your-website-with-cloudflare-cdn/)

## 0x02 什么是AS（自治系统）

> 互联网（Internet）是由不同网络组成的网络，自治系统是组成互联网的大型网络。更具体的说，自治系统是具有统一路由策略的巨型网络或网络群组，连接到 Internet 的每台计算机或设备都连接到一个AS

为了方便理解，打个比方，假如现在房间里的两台家用路由器就是2个单独的AS，称为AS1、AS2，忽略掉内外网的概念，AS1负责解析1.1.1.1~2.2.2.2网段，AS2负责3.3.3.3~4.4.4.4网段，所有拉网线到AS1这台路由器的设备会获取这个网段的一个IP，其他设备也都接到这个路由器下，那么设备之间就可以使用AS1网段的IP来进行局域网的通信了。

假设现在有20个这样的路由器（想象为20个AS），且AS之间建立连接的方式只有物理拉网线，AS1和AS2直接网线对接，通过路由协议同步了两边可以解析的IP，由此，2个“局域网”就可以实现相互通信了。

由于直接相连的AS之间会根据路由协议同步路由表，因此即使20台路由器串连，每台设备最终也可以知道其他全部的AS的路由器情况。比如 `AS1 <=> AS2 <=> AS3`，对于AS2来说AS1、2、3的路由表它都知道，并且也能告诉AS1、3，所以AS1也知道AS3的路由表，即使他们没有直接相连。对于拉网线接到了AS1的设备，自己的AS1（边界）知道目标IP归属于哪个具体的AS，从而就可以传输数据实现通信。

真实世界的AS就是上面所述的扩大化，由国家、运营商、跨国公司运营的网络集群就是AS，单个AS可以看作一个巨大的“局域网”，AS之间也是根据地理位置来拉网线，比如沪日专线、太平洋光缆等等。

![](https://takuya-1305710862.cos.ap-shanghai.myqcloud.com/A1ways0nline/pic/20241010101806.png)
